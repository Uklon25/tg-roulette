<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8" />
<title>–†—É–ª–µ—Ç–∫–∞ –ø–æ–¥–∞—Ä–∫–æ–≤</title>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  html, body {
    margin: 0; padding: 0; background: #121212; color: #eee; font-family: Arial,sans-serif;
    min-height: 100vh; width: 100vw; overflow-x: hidden;
  }
  #main-content {
    flex: 1; width: 100vw; max-width: 430px; margin: 0 auto;
    box-sizing: border-box; padding-top: 16px;
    display: flex; flex-direction: column; align-items: center;
  }
  #profile, #roulette, #inventory {
    width: 100%; max-width: 430px; box-sizing: border-box; padding: 0 8px;
  }
  #wheel {
    background: #222; border-radius: 50%; box-shadow: 0 0 15px #0f0;
    margin-bottom: 18px; width: 95vw; max-width: 320px; height: 95vw; max-height: 320px; display: block;
  }
  .pointer {
    width: 0; height: 0; 
    border-left: 20px solid transparent;
    border-right: 20px solid transparent;
    border-bottom: 28px solid #0f0;
    margin-bottom: -13px; margin-left: auto; margin-right: auto;
    display: block; position: relative; top: 8px; z-index: 2;
  }
  #controls {
    margin-bottom: 12px; width: 100%; box-sizing: border-box; max-width: 340px;
    margin-left: auto; margin-right: auto; display: flex; flex-direction: column; align-items: center;
  }
  #luckButtons {
    display: flex; flex-wrap: wrap; justify-content: center; gap: 7px; margin-bottom: 8px;
  }
  #luckButtons button { min-width: 90px; }
  button {
    background: #0a0; color: #cfc; border: none; padding: 10px 12px; margin: 5px 3px;
    border-radius: 6px; font-weight: bold; font-size: 1em; cursor: pointer; transition: background 0.3s ease;
    min-width: 70px; box-sizing: border-box;
  }
  button:disabled { background: #444; cursor: not-allowed; }
  #balance { font-size: 1.2em; margin-bottom: 12px; text-align: center; }
  #prizeInfo { font-size: 1.1em; margin-top: 12px; min-height: 26px; text-align: center; word-break: break-word;}
  #luckButtons button.active { background: #4caf50; box-shadow: 0 0 8px #4caf50; }
  .bottom-nav {
    position: fixed; bottom: 0; left: 0; right: 0; width: 100vw; max-width: 430px; margin: 0 auto; z-index: 100;
    display: flex; justify-content: space-around; background: #222; border-top: 1px solid #333; padding: 0; height: 56px;
  }
  .bottom-nav button {
    flex: 1; margin: 0 2px; font-size: 1.05em; padding: 13px 0; border-radius: 5px;
    background: #111; color: #eee; border: none; transition: background .25s;
    min-width: 0; min-height: 36px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis;
  }
  .bottom-nav button.active { background: #0a0; color: #fff; box-shadow: 0 0 8px #0f0; }
  .inventory-list {
    display: flex; flex-direction: column; gap: 7px; margin-top: 10px; padding-bottom: 60px; width: 100%; align-items: stretch;
  }
  .inventory-item {
    background: #232323; border-radius: 8px; padding: 10px 10px 10px 14px; min-width: 110px;
    display: flex; align-items: center; justify-content: space-between; color: #fff; font-size: 1em; border: 1px solid #333;
    margin: 3px 0; word-break: break-word; box-sizing: border-box;
  }
  .profile-info { padding: 20px 0 8px 0; font-size: 1.1em; text-align: center; color: #fff; }
  .chance-table-title { text-align: center; font-size: 1.1em; margin: 12px 0 3px 0; font-weight: bold; color: #8cff8c; letter-spacing: 1px;}
  .chance-table {
    width: 100%; max-width: 350px; margin: 0 auto 10px auto; border-collapse: collapse; font-size: 0.98em;
    background: #232323; border-radius: 6px; overflow: hidden;
  }
  .chance-table th, .chance-table td { padding: 5px 4px; border: 1px solid #333; text-align: center; }
  .chance-table th { background: #191919; color: #9aff9a; font-weight: bold;}
  .chance-table td { color: #eee; }
  .chance-table tr:nth-child(even) td { background: #181818; }
  .chance-table tr:nth-child(odd) td { background: #232323; }
  .sell-all-btn {
    width: 100%; box-sizing: border-box; background: #e33; color: #fff; font-weight: bold; margin-bottom: 6px;
    padding: 12px; border-radius: 8px; font-size: 1.07em; border: none; cursor: pointer;
  }
  .sell-btn {
    background: #e33; color: #fff; border-radius: 5px; border: none; font-size: 1em; padding: 7px 13px; margin-left: 10px;
    cursor: pointer; font-weight: bold; transition: background 0.2s;
  }
  .sell-btn:disabled { background: #444; color: #bbb; }
  @media (max-width: 600px) {
    #main-content, #profile, #roulette, #inventory, .bottom-nav { max-width: 100vw; min-width: 0; padding-left: 0; padding-right: 0;}
    .inventory-item { min-width: 44vw; font-size: .99em;}
    #controls { max-width: 98vw;}
    #wheel { max-width: 98vw; max-height: 98vw;}
    .bottom-nav { padding: 0; height: 54px;}
    .bottom-nav button { font-size: .97em; padding: 10px 0;}
    .chance-table { font-size: 0.9em; max-width: 100vw;}
  }
</style>
</head>
<body>

<div id="main-content">
  <div id="profile" style="display:none;">
    <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
    <div class="profile-info">
      <div>üë§ –ò–º—è: <span id="username">User</span></div>
      <div>‚≠ê –ë–∞–ª–∞–Ω—Å: <span id="balanceValueProfile">1000</span></div>
      <div id="addStarsBtnWrap" style="margin-top:12px; display:none;">
        <button id="addStarsBtn">+1000 ‚≠ê</button>
      </div>
    </div>
  </div>
  <div id="roulette">
    <h2>–†—É–ª–µ—Ç–∫–∞ –ø–æ–¥–∞—Ä–∫–æ–≤</h2>
    <div id="balance">–ë–∞–ª–∞–Ω—Å: <span id="balanceValue">1000</span> ‚≠ê</div>
    <div class="pointer"></div>
    <canvas id="wheel" width="320" height="320"></canvas>
    <div id="controls">
      <div id="luckButtons">
        <button data-cost="25">–°—Ç–∞–≤–∫–∞ 25 ‚≠ê</button>
        <button data-cost="50">–°—Ç–∞–≤–∫–∞ 50 ‚≠ê</button>
        <button data-cost="100">–°—Ç–∞–≤–∫–∞ 100 ‚≠ê</button>
      </div>
      <div>
        <button id="spinBtn" disabled>–ö—Ä—É—Ç–∏—Ç—å</button>
        <button id="spinAgainBtn" disabled>–ö—Ä—É—Ç–∏—Ç—å –µ—â—ë</button>
        <button id="sellPrizeBtn" disabled>–ü—Ä–æ–¥–∞—Ç—å –ø—Ä–∏–∑</button>
      </div>
    </div>
    <div id="prizeInfo"></div>
    <div class="chance-table-title">–¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–∑–æ–≤</div>
    <div id="chanceTables"></div>
  </div>
  <div id="inventory" style="display:none;">
    <h2>–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</h2>
    <button class="sell-all-btn" id="sellAllBtn">–ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë</button>
    <div id="inventoryCount" style="color:#eee;font-size:1.07em;margin-bottom:4px;text-align:center;width:100%"></div>
    <div id="inventoryList" class="inventory-list"></div>
  </div>
</div>

<nav class="bottom-nav">
  <button id="navProfile">–ü—Ä–æ—Ñ–∏–ª—å</button>
  <button id="navRoulette" class="active">–†—É–ª–µ—Ç–∫–∞</button>
  <button id="navInventory">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å</button>
</nav>

<script>
  // --- –ù–ê–í–ò–ì–ê–¶–ò–Ø ---
  const navBtns = {
    profile: document.getElementById("navProfile"),
    roulette: document.getElementById("navRoulette"),
    inventory: document.getElementById("navInventory"),
  };
  const screens = {
    profile: document.getElementById("profile"),
    roulette: document.getElementById("roulette"),
    inventory: document.getElementById("inventory"),
  };
  function showScreen(screen) {
    for (let k of Object.keys(screens)) {
      screens[k].style.display = (k === screen) ? "" : "none";
      navBtns[k].classList.toggle("active", k === screen);
    }
    if (screen === "profile") updateProfile();
    if (screen === "inventory") { updateInventory(); updateInventoryCount(); }
  }
  navBtns.profile.onclick = () => showScreen("profile");
  navBtns.roulette.onclick = () => showScreen("roulette");
  navBtns.inventory.onclick = () => showScreen("inventory");

  // --- –ü–†–ò–ó–´ ---
  const prizesData = {
    25: [
      { emoji: "üß∏", label: "–ú–∏—à–∫–∞", price: 15 },
      { emoji: "‚ù§Ô∏è", label: "–°–µ—Ä–¥—Ü–µ", price: 15 },
      { emoji: "üéÅ", label: "–ö–æ—Ä–æ–±–∫–∞", price: 25 },
      { emoji: "üåπ", label: "–†–æ–∑–∞", price: 25 },
      { emoji: "üöÄ", label: "–†–∞–∫–µ—Ç–∞", price: 50 },
      { emoji: "üçæ", label: "–®–∞–º–ø–∞–Ω—Å–∫–æ–µ", price: 50 },
      { emoji: "üíç", label: "–ö–æ–ª—å—Ü–æ", price: 100 },
      { emoji: "‚ùå", label: "–ü—É—Å—Ç–æ", price: 0 }
    ],
    50: [
      { emoji: "üß∏", label: "–ú–∏—à–∫–∞", price: 15 },
      { emoji: "‚ù§Ô∏è", label: "–°–µ—Ä–¥—Ü–µ", price: 15 },
      { emoji: "üéÅ", label: "–ö–æ—Ä–æ–±–∫–∞", price: 25 },
      { emoji: "üåπ", label: "–†–æ–∑–∞", price: 25 },
      { emoji: "üíê", label: "–ë—É–∫–µ—Ç", price: 50 },
      { emoji: "üöÄ", label: "–†–∞–∫–µ—Ç–∞", price: 50 },
      { emoji: "üçæ", label: "–®–∞–º–ø–∞–Ω—Å–∫–æ–µ", price: 50 },
      { emoji: "üíç", label: "–ö–æ–ª—å—Ü–æ", price: 100 },
      { emoji: "üèÜ", label: "–ö—É–±–æ–∫", price: 100 },
      { emoji: "üéÇ", label: "–¢–æ—Ä—Ç", price: 50 },
      { emoji: "‚ùå", label: "–ü—É—Å—Ç–æ", price: 0 }
    ],
    100: [
      { emoji: "üß∏", label: "–ú–∏—à–∫–∞", price: 15 },
      { emoji: "‚ù§Ô∏è", label: "–°–µ—Ä–¥—Ü–µ", price: 15 },
      { emoji: "üéÅ", label: "–ö–æ—Ä–æ–±–∫–∞", price: 25 },
      { emoji: "üåπ", label: "–†–æ–∑–∞", price: 25 },
      { emoji: "üíê", label: "–ë—É–∫–µ—Ç", price: 50 },
      { emoji: "üöÄ", label: "–†–∞–∫–µ—Ç–∞", price: 50 },
      { emoji: "üçæ", label: "–®–∞–º–ø–∞–Ω—Å–∫–æ–µ", price: 50 },
      { emoji: "üíç", label: "–ö–æ–ª—å—Ü–æ", price: 100 },
      { emoji: "üèÜ", label: "–ö—É–±–æ–∫", price: 100 },
      { emoji: "üéÇ", label: "–¢–æ—Ä—Ç", price: 50 },
      { emoji: "üíé", label: "–ê–ª–º–∞–∑", price: 100 },
      { emoji: "üéâ", label: "–¢–∞–±–ª–∏—á–∫–∞", price: 350 },
      { emoji: "‚ùå", label: "–ü—É—Å—Ç–æ", price: 0 }
    ]
  };

  let balance = 1000;
  let currentCost = null;
  let spinning = false;
  let currentPrize = null;
  let inventory = []; // {emoji,label,price,invId}

  // --- Telegram WebApp User Info ---
  let tgUserId = null;
  let tgUserName = "User";
  if (
    window.Telegram && window.Telegram.WebApp &&
    window.Telegram.WebApp.initDataUnsafe &&
    window.Telegram.WebApp.initDataUnsafe.user
  ) {
    tgUserId = window.Telegram.WebApp.initDataUnsafe.user.id;
    tgUserName = window.Telegram.WebApp.initDataUnsafe.user.first_name || "User";
  }
  document.getElementById("username").textContent = tgUserName;

  // --- –ö–Ω–æ–ø–∫–∞ +1000 —Ç–æ–ª—å–∫–æ –¥–ª—è –Ω—É–∂–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ---
  const addStarsBtnWrap = document.getElementById("addStarsBtnWrap");
  if (tgUserId === 6774136020) addStarsBtnWrap.style.display = "";
  else addStarsBtnWrap.style.display = "none";

  function updateProfile() {
    document.getElementById("balanceValueProfile").textContent = balance;
  }

  function updateInventory() {
    const invList = document.getElementById('inventoryList');
    invList.innerHTML = "";
    if (inventory.length === 0) {
      invList.innerHTML = `<div style="color:#888;">–ò–Ω–≤–µ–Ω—Ç–∞—Ä—å –ø—É—Å—Ç.</div>`;
      document.getElementById('sellAllBtn').disabled = true;
      return;
    }
    document.getElementById('sellAllBtn').disabled = false;
    // –î–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ–¥–º–µ—Ç–∞ –∫–Ω–æ–ø–∫–∞ –ø—Ä–æ–¥–∞—Ç—å
    inventory.forEach(item => {
      let div = document.createElement("div");
      div.className = "inventory-item";
      div.innerHTML = `
        <span>${item.emoji} ${item.label} <span style="color:#aaa;">(${item.price} ‚≠ê)</span></span>
        <button class="sell-btn" data-invid="${item.invId}">–ü—Ä–æ–¥–∞—Ç—å</button>
      `;
      invList.appendChild(div);
    });
    // –ù–∞–≤–µ—à–∏–≤–∞–µ–º —Å–æ–±—ã—Ç–∏—è –Ω–∞ "–ü—Ä–æ–¥–∞—Ç—å"
    document.querySelectorAll('.sell-btn').forEach(btn => {
      btn.onclick = function() {
        const invId = btn.getAttribute('data-invid');
        sellInventoryItem(invId);
      };
    });
  }
  function updateInventoryCount() {
    document.getElementById('inventoryCount').textContent =
      `üéÅ –ü—Ä–µ–¥–º–µ—Ç–æ–≤ –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä–µ: ${inventory.length}`;
  }

  const balanceElem = document.getElementById("balanceValue");
  const prizeInfo = document.getElementById("prizeInfo");
  const luckButtons = [...document.querySelectorAll("#luckButtons button")];
  const spinBtn = document.getElementById("spinBtn");
  const spinAgainBtn = document.getElementById("spinAgainBtn");
  const sellPrizeBtn = document.getElementById("sellPrizeBtn");
  const sellAllBtn = document.getElementById("sellAllBtn");

  const canvas = document.getElementById("wheel");
  const ctx = canvas.getContext("2d");

  // --- Canvas –∞–¥–∞–ø—Ç–∞—Ü–∏—è ---
  function fitCanvas() {
    let size = Math.min(window.innerWidth * 0.95, 320);
    canvas.width = canvas.height = size;
  }
  fitCanvas();
  window.addEventListener("resize", () => { fitCanvas(); drawWheel(); });

  function getWheelGeom() {
    return {
      wheelRadius: canvas.width / 2 - 10,
      centerX: canvas.width / 2,
      centerY: canvas.height / 2
    };
  }

  let currentAngle = 0;
  let currentPrizes = [];

  function updateBalanceUI() {
    balanceElem.textContent = balance;
    document.getElementById("balanceValueProfile").textContent = balance;
  }

  function updateButtonsState() {
    if (spinning) {
      spinBtn.disabled = true;
      spinAgainBtn.disabled = true;
      sellPrizeBtn.disabled = true;
      luckButtons.forEach(btn => btn.disabled = true);
      return;
    }
    spinBtn.disabled = !currentCost || balance < currentCost;
    spinAgainBtn.disabled = !currentPrize || balance < currentCost;
    sellPrizeBtn.disabled = !currentPrize;
    luckButtons.forEach(btn => btn.disabled = spinning);
  }

  function drawWheel(highlightSegmentIdx = null) {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (!currentCost) {
      ctx.fillStyle = "#555";
      ctx.font = (canvas.width * 0.07 | 0) + "px Arial";
      ctx.textAlign = "center";
      ctx.fillText("–í—ã–±–µ—Ä–∏—Ç–µ —Å—Ç–∞–≤–∫—É", canvas.width / 2, canvas.height / 2);
      return;
    }
    const prizes = currentPrizes;
    let startAngle = currentAngle;
    const { wheelRadius, centerX, centerY } = getWheelGeom();
    const N = prizes.length;
    const sectorAngle = 2 * Math.PI / N;

    for (let i = 0; i < N; ++i) {
      let sA = startAngle + i * sectorAngle;
      let eA = startAngle + (i + 1) * sectorAngle;
      ctx.beginPath();
      ctx.moveTo(centerX, centerY);
      ctx.arc(centerX, centerY, wheelRadius, sA, eA);
      ctx.closePath();
      ctx.fillStyle = (i % 2 === 0) ? "#0b0" : "#097c09";
      if (highlightSegmentIdx === i) ctx.fillStyle = "#26e326";
      ctx.fill();
      ctx.strokeStyle = "#000";
      ctx.lineWidth = 2;
      ctx.stroke();

      // –≠–º–æ–¥–∑–∏ + –ø–æ–¥–ø–∏—Å—å
      ctx.save();
      ctx.translate(centerX, centerY);
      ctx.rotate(sA + sectorAngle / 2 - Math.PI / 2);
      ctx.textAlign = "center";
      ctx.font = (canvas.width * 0.11 | 0) + "px Arial";
      ctx.fillStyle = "#fff";
      ctx.fillText(prizes[i].emoji, wheelRadius * 0.68, 0);
      ctx.font = (canvas.width * 0.055 | 0) + "px Arial";
      ctx.fillText(prizes[i].label, wheelRadius * 0.68, canvas.width * 0.055);
      ctx.restore();
    }
  }

  function selectPrizeIdx() {
    const prizes = currentPrizes;
    return Math.floor(Math.random() * prizes.length);
  }

  function getTargetAngleEven(idx, N) {
    const sectorAngle = 2 * Math.PI / N;
    let centerOfSegment = idx * sectorAngle + sectorAngle / 2;
    let targetAngle = 1.5 * Math.PI - centerOfSegment;
    while (targetAngle < 0) targetAngle += 2 * Math.PI;
    while (targetAngle >= 2 * Math.PI) targetAngle -= 2 * Math.PI;
    return targetAngle;
  }

  function animateSpin(targetAngle, highlightIdx, duration = 4000) {
    spinning = true;
    updateButtonsState();

    let start = null;
    let startAngleAnim = currentAngle % (2 * Math.PI);
    if (startAngleAnim < 0) startAngleAnim += 2 * Math.PI;
    let diffAngle = targetAngle - startAngleAnim + (4 * 2 * Math.PI);

    function step(timestamp) {
      if (!start) start = timestamp;
      let elapsed = timestamp - start;
      let progress = Math.min(elapsed / duration, 1);
      let eased = 1 - Math.pow(1 - progress, 3);
      currentAngle = startAngleAnim + diffAngle * eased;
      drawWheel(highlightIdx);
      if (progress < 1) {
        requestAnimationFrame(step);
      } else {
        currentAngle = targetAngle;
        spinning = false;
        updateButtonsState();
        drawWheel(highlightIdx);
        showPrize();
      }
    }
    requestAnimationFrame(step);
  }

  function showPrize() {
    if (!currentPrize) return;
    if (currentPrize.price === 0) {
      prizeInfo.textContent = `–£–≤—ã, –ø—É—Å—Ç–æ. –ù–∏—á–µ–≥–æ –Ω–µ –≤—ã–∏–≥—Ä–∞–ª–∏.`;
      currentPrize = null;
    } else {
      prizeInfo.textContent = `–í—ã –≤—ã–∏–≥—Ä–∞–ª–∏: ${currentPrize.emoji} ${currentPrize.label}! (–¶–µ–Ω–∞: ${currentPrize.price}‚≠ê)`;
      // –î–æ–±–∞–≤–ª—è–µ–º –ø—Ä–µ–¥–º–µ—Ç –≤ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—å —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID
      const invId = Math.random().toString(36).slice(2) + Date.now();
      inventory.push({ ...currentPrize, invId });
      // –û—á–∏—â–∞–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–∏–∑ (–∏–Ω–∞—á–µ –º–æ–∂–Ω–æ –±—É–¥–µ—Ç –ø—Ä–æ–¥–∞—Ç—å –¥–≤–∞–∂–¥—ã!)
      currentPrize = null;
    }
    updateInventory();
    updateInventoryCount();
    updateButtonsState();
  }

  luckButtons.forEach(btn => {
    btn.addEventListener("click", () => {
      if (spinning) return;
      luckButtons.forEach(b => b.classList.remove("active"));
      btn.classList.add("active");
      currentCost = +btn.dataset.cost;
      // –°—Ç–∞–≤–∏–º –∞–∫—Ç—É–∞–ª—å–Ω—ã–π –º–∞—Å—Å–∏–≤ –ø—Ä–∏–∑–æ–≤
      currentPrizes = prizesData[currentCost].map(x => ({...x}));
      currentPrize = null;
      prizeInfo.textContent = "";
      spinAgainBtn.disabled = true;
      sellPrizeBtn.disabled = true;
      updateButtonsState();
      drawWheel();
    });
  });

  spinBtn.addEventListener("click", () => {
    if (spinning || !currentCost) return;
    if (balance < currentCost) {
      alert("–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –±–∞–ª–∞–Ω—Å–∞ –¥–ª—è —Å—Ç–∞–≤–∫–∏!");
      return;
    }
    balance -= currentCost;
    updateBalanceUI();
    let idx = selectPrizeIdx();
    currentPrize = { ...currentPrizes[idx] }; // –∫–æ–ø–∏—è
    spinAgainBtn.disabled = false;
    sellPrizeBtn.disabled = false;
    let targetAngle = getTargetAngleEven(idx, currentPrizes.length);
    animateSpin(targetAngle, idx);
  });

  spinAgainBtn.addEventListener("click", () => {
    if (spinning || !currentCost || balance < currentCost) return;
    currentPrize = null;
    prizeInfo.textContent = "";
    balance -= currentCost;
    updateBalanceUI();
    let idx = selectPrizeIdx();
    currentPrize = { ...currentPrizes[idx] };
    spinAgainBtn.disabled = false;
    sellPrizeBtn.disabled = false;
    let targetAngle = getTargetAngleEven(idx, currentPrizes.length);
    animateSpin(targetAngle, idx);
  });

  sellPrizeBtn.addEventListener("click", () => {
    if (!currentPrize) return;
    if (currentPrize.price > 0) {
      balance += currentPrize.price;
      updateBalanceUI();
      prizeInfo.textContent = `–í—ã –ø—Ä–æ–¥–∞–ª–∏ ${currentPrize.emoji} ${currentPrize.label} –∑–∞ ${currentPrize.price}‚≠ê`;
    }
    currentPrize = null;
    spinAgainBtn.disabled = true;
    sellPrizeBtn.disabled = true;
    updateButtonsState();
  });

  // –ü—Ä–æ–¥–∞—Ç—å –ø—Ä–µ–¥–º–µ—Ç –∏–∑ –∏–Ω–≤–µ–Ω—Ç–∞—Ä—è
  function sellInventoryItem(invId) {
    let idx = inventory.findIndex(i => i.invId === invId);
    if (idx !== -1) {
      let item = inventory[idx];
      balance += item.price;
      updateBalanceUI();
      inventory.splice(idx, 1);
      updateInventory();
      updateInventoryCount();
    }
  }

  // –ü—Ä–æ–¥–∞—Ç—å –≤—Å—ë
  sellAllBtn.onclick = function() {
    if (inventory.length === 0) return;
    let sum = 0;
    inventory.forEach(item => { sum += item.price; });
    balance += sum;
    updateBalanceUI();
    inventory = [];
    updateInventory();
    updateInventoryCount();
  };

  // –ö–Ω–æ–ø–∫–∞ +1000 –∑–≤–µ–∑–¥ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∞)
  document.getElementById("addStarsBtn").onclick = function () {
    balance += 1000;
    updateBalanceUI();
    updateProfile();
  };

  // --- –¢–∞–±–ª–∏—Ü–∞ –ø—Ä–∏–∑–æ–≤ ---
  function renderChanceTables() {
    let html = '';
    [25, 50, 100].forEach(cost => {
      html += `<div style="margin-bottom:9px;"><b>–°—Ç–∞–≤–∫–∞ ${cost} ‚≠ê</b><table class="chance-table"><tr><th>–ü—Ä–∏–∑</th><th>–¶–µ–Ω–∞</th></tr>`;
      prizesData[cost].forEach(item => {
        html += `<tr><td>${item.emoji} ${item.label}</td><td>${item.price ? item.price + " ‚≠ê" : "-"}</td></tr>`;
      });
      html += `</table></div>`;
    });
    document.getElementById('chanceTables').innerHTML = html;
  }

  // --- –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è ---
  updateBalanceUI();
  updateButtonsState();
  // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∞–∫—Ç–∏–≤–∏—Ä—É–µ–º —Å—Ç–∞–≤–∫—É 25
  currentCost = 25;
  currentPrizes = prizesData[currentCost].map(x => ({...x}));
  luckButtons[0].classList.add('active');
  drawWheel();
  showScreen('roulette');
  updateInventory();
  updateInventoryCount();
  renderChanceTables();

</script>
</body>
</html>
